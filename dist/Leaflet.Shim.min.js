L.Shim=L.Class.extend({includes:L.Mixin.Events,options:{className:"leaflet-backdrop"},statics:{EVENTS:"click dblclick mouseover mouseout mousemove "+"contextmenu touchstart touchend touchmove"},initialize:function(t){this._anchor=new L.Point(0,0);L.Util.setOptions(this,t)},addTo:function(t){this._map=t;t.addLayer(this);return this},onAdd:function(t){if(!this._container){this._container=L.DomUtil.create("div",this.options.className);t._panes.popupPane.insertBefore(this._container,t._panes.popupPane.firstChild)}L.DomEvent.on(this._container,L.Shim.EVENTS,this._propagateEvents,this);t.on("zoomend moveend",this._update,this);this._update()},removeFrom:function(t){t.removeLayer(this);return this},_update:function(){var t=this._map.getSize(),i=this._map.containerPointToLayerPoint(this._anchor),e=this._container.style;e.cursor=this._map._container.style.cursor;e.width=t.x+"px";e.height=t.y+"px";L.DomUtil.setPosition(this._container,i)},onRemove:function(t){L.DomEvent.off(this._container,L.Shim.EVENTS,this._propagateEvents,this);if(this._container){this._container.parentNode.removeChild(this._container);this._container=null}this._map.off("zoomend moveend",this._update,this)},_propagateEvents:function(t){this._map.fire(t.type,t)}});